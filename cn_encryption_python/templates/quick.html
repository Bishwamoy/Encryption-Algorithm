
{% extends "base.html" %}
{% block content %}
<h2 class="title">Quick Encrypt • {{ scenario.upper() }}</h2>
<p class="subtitle">Input: {{ msg_len }} bytes • Repeat: {{ repeat }} • Source: {{ src_label }}</p>

<div class="grid md:grid-cols-2 gap-4">
  {% for r in rows %}
  <div class="card">
    <div class="flex items-center justify-between mb-2">
      <div class="font-medium">{{ r.algo }} {{ r.variant }}</div>
      <span class="badge">{{ "AEAD" if r.aead else "Enc+MAC" }}</span>
    </div>
    <div class="text-xs text-slate-400 mb-2">Mean {{ "%.4f"|format(r.mean_ms) }} ms • p95 {{ "%.4f"|format(r.p95_ms) }} ms</div>
    <div class="mono small break-all mb-2"><b>ciphertext:</b> <span id="ct-{{ loop.index }}">{{ r.ciphertext_b64 }}</span></div>
    <div class="mono small break-all mb-2"><b>key:</b> <span id="key-{{ loop.index }}">{{ r.key_b64 }}</span></div>
    {% if r.nonce_b64 %}<div class="mono small break-all mb-2"><b>nonce/iv:</b> <span id="nonce-{{ loop.index }}">{{ r.nonce_b64 }}</span></div>{% endif %}
    {% if r.ad_b64 %}<div class="mono small break-all mb-2"><b>aad:</b> <span id="ad-{{ loop.index }}">{{ r.ad_b64 }}</span></div>{% endif %}
    {% if r.tag_b64 %}<div class="mono small break-all mb-2"><b>tag:</b> <span id="tag-{{ loop.index }}">{{ r.tag_b64 }}</span></div>{% endif %}
    <div class="flex gap-2 mt-2">
      <button class="btn-secondary" onclick="copyText('ct-{{ loop.index }}')">Copy ciphertext</button>
      <button class="btn-secondary" onclick="copyText('key-{{ loop.index }}')">Copy key</button>
    </div>
  </div>
  {% endfor %}
</div>

<a href="{{ url_for('index') }}" class="btn-secondary mt-6">← Back</a>
{% endblock %}
